<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Timeregistrering</title>
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/latest/css/bootstrap.min.css">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.1.1/jquery.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
    <link rel="stylesheet" type="text/css" href="templates/footer.css" />
</head>
<body>
<div class="container">
    {% include 'header.html' %}
    <span class="glyphicon glyphicon-arrow-left"></span><a href="index.php">Hovedside</a>
    <h1>Timeregistrering</h1>
    
    {% if error == "ugyldigId" %}
        <div class="alert alert-danger" role="alert">
            <span class="glyphicon glyphicon-exclamation-sign" aria-hidden="true"></span>
            <span class="sr-only">Error:</span>
            Ugyldig ID
        </div>
    {% elseif error == "ugyldigProsjekt" %}
        <div class="alert alert-danger" role="alert">
            <span class="glyphicon glyphicon-exclamation-sign" aria-hidden="true"></span>
            <span class="sr-only">Error:</span>
            Du har ikke tilgang til prosjektet
        </div>
    {% elseif error == "ugyldigOppgave" %}
        <div class="alert alert-danger" role="alert">
            <span class="glyphicon glyphicon-exclamation-sign" aria-hidden="true"></span>
            <span class="sr-only">Error:</span>
            Du har ikke tilgang til oppgaven
        </div>
    {% elseif error == "ugyldigTimereg" %}
        <div class="alert alert-danger" role="alert">
            <span class="glyphicon glyphicon-exclamation-sign" aria-hidden="true"></span>
            <span class="sr-only">Error:</span>
            Du har ikke tilgang til denne timeregistreringen
        </div>
    {% elseif error == "ugyldigPause" %}
        <div class="alert alert-danger" role="alert">
            <span class="glyphicon glyphicon-exclamation-sign" aria-hidden="true"></span>
            <span class="sr-only">Error:</span>
            For å kunne sette en timeregistrering på pause må det være en startet timeregistrering.
        </div>
    {% elseif error == "ugyldigFortsettelse" %}
        <div class="alert alert-danger" role="alert">
            <span class="glyphicon glyphicon-exclamation-sign" aria-hidden="true"></span>
            <span class="sr-only">Error:</span>
            For å fortsette en timeregistreringen må den være satt på pause.
        </div>
    {% elseif error == "ugyldigStopp" %}
        <div class="alert alert-danger" role="alert">
            <span class="glyphicon glyphicon-exclamation-sign" aria-hidden="true"></span>
            <span class="sr-only">Error:</span>
            Timeregistreringen er allerede stoppet, og kan derfor ikke stoppes.
        </div>
    {% elseif error == "alleredeAktivTimereg" %}
        <div class="alert alert-danger" role="alert">
            <span class="glyphicon glyphicon-exclamation-sign" aria-hidden="true"></span>
            <span class="sr-only">Error:</span>
            Du kan kun ha en aktiv timeregistrering om gangen. Du må stoppe den aktive timeregistreringen før du starter en ny.
        </div>
    {% elseif error == "ugyldigTimeEst" %}
        <div class="alert alert-danger" role="alert">
            <span class="glyphicon glyphicon-exclamation-sign" aria-hidden="true"></span>
            <span class="sr-only">Error:</span>
            Du har ikke tilgang til å foreslå tidsestimat på oppgaven.
        </div>
    {% endif %}
    {% if sendt %}
    <div class="alert alert-success" role="alert">
        <span class="glyphicon glyphicon-exclamation-sign" aria-hidden="true"></span>
        <span class="sr-only">Error:</span>
        Forslag er sendt!
    </div>
    {% endif %}
        
    <form method="post" action="timeregistrering.php" class="col-md-4" id="timeregForm">
        <div class="form-group">
            <label for="prosjekt">Prosjekt:</label>
        {% if aktiv %}
            <select class="form-control" name="prosjektId" id="prosjekt" disabled>
                <option value="{{ prosjekt.Id }}" selected>{{ prosjekt.Navn }}</option>
            </select>
        {% else %}
            <select class="form-control" name="prosjektId" id="prosjekt" onchange="document.getElementById('timeregForm').submit();">
                {% if valgtProsjekt < 1 %}
                <option selected="selected"></option>
                {% endif %}
                {% for prosjekt in prosjektListe %}
                <option value="{{ prosjekt.Id }}"{% if prosjekt.Id == valgtProsjekt %} selected="selected"{% endif %}>{{ prosjekt.Navn }}</option>
                {% endfor %}
            </select>
            {% if valgtProsjekt < 1 %}
            <small class="form-text text-muted">Velg prosjekt</small>
            {% elseif oppgaveListe|length == 0 %}
            <small class="form-text text-muted">Valgt prosjekt har ingen oppgaver</small>
            {% endif %}
        {% endif %}
        </div>
    </form>
    {% if visSkjema %}
    <form method="post" action="timeregistrering.php" class="col-md-4">
        <input type="hidden" name="timeregId" value="{{ registrering.Id }}">
        <div class="form-group ">
            <label for="oppgave">Oppgave:</label>
            <div class="form-inline">
                {% if aktiv %}
                <select name="oppgave" class="form-control" disabled id="oppgave">
                    <option value="{{ oppgave.Id }}" selected="selected">{{ oppgave.Navn }}
                    </option>
                </select>
                {% else %}
                <select name="oppgave" class="form-control" id="oppgave">
                    {% for oppgave in oppgaveListe %}
                    <option value="{{ oppgave.Id }}" {% if oppgave.Id== valgtOppgave %}
                            selected="selected" {% endif %}>{{ oppgave.Navn }}
                    </option>
                    {% endfor %}
                </select>
                {% endif %}
                <input class="btn btn-primary" type="submit" name="forslag" value="Foreslå tidsestimat">
            </div>
        </div>

        <div class="form-group ">
            <label for="dato">Dato:</label>
            <input type="date" class="form-control" id="dato" name="dato" disabled value="{{ dagensdato }}">
        </div>
        <div class="form-group">
            {% if aktiv %}
                <input class="btn btn-lg" type="submit" name="submit" value="Start" disabled/>
                {% if registrering.Status == 1 %}
                <input class="btn btn-success btn-lg" type="submit" name="submit" value="Fortsett"/>
                {% else %}
                <input class="btn btn-primary btn-lg" type="submit" name="submit" value="Pause"/>
                {% endif %}
                <input class="btn btn-danger btn-lg" type="submit" name="submit" value="Stopp"/>
            {% else %}
                <input class="btn btn-success btn-lg" type="submit" name="submit" value="Start"/>
                <input class ="btn btn-lg" type="submit" name="submit" value="Pause" disabled/>
                <input class="btn btn-lg" type="submit" name="submit" value="Stopp" disabled/>
            {% endif %}
        </div>
    </form>
    {% endif %}
</div>
{% include 'footer.html' %}
</body>
</html>