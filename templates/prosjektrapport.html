<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Prosjektrapport</title>
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/latest/css/bootstrap.min.css">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.1.1/jquery.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
</head>
<body>
    <div class="container">
        {% include 'header.html' %}
        <span class="glyphicon glyphicon-arrow-left"></span><a href="prosjektdetaljer.php?prosjekt={{ prosjekt.getId() }}">Prosjektdetaljer</a>

        {% if type == "fremdrift" %}
            <h1>Fremdriftsrapport for prosjekt {{ prosjekt.getNavn() }}</h1>
        {% else %}
            <h1>Prosjektrapport for prosjekt {{ prosjekt.getNavn() }}</h1>
        {% endif %}

        <form method=get class="col-md-4">
            <input type="hidden" name="prosjektId" value="{{ prosjekt.getId() }}"/>
            <div class="form-group">
                <label for="rapportType">Type rapport:</label>
                <select id=rapportType name=rapportType class="form-control" onchange="submit()">
                    <option value="team">Pr. Team</option>
                    <option value="prosjekt" {% if type == "prosjekt" %}selected{% endif %}>Pr. Delprosjekt</option>
                    <option value="oppgave"{% if type == "oppgave" %}selected{% endif %}>Pr. Oppgave</option>
                    <option value="fremdrift"{% if type == "fremdrift" %}selected{% endif %}>Fremdriftsrapport</option>
                </select>
            </div>
        </form>

        <div class="rapport">
            {% if type == "team" %}
            {% elseif type == "prosjekt" %}
            <table class="table table-striped">
                <tr>
                    <th>Prosjekt</th>
                    {% for oType in  oppgaveTyper %}
                        <th>{{ oType.Navn }}</th>
                    {% endfor %}
                    <th>Sum</th>
                </tr>
                <!--<tr>
                    <td>{{ oversikt.getProsjekt().getNavn() }}</td>
                    <td>{{ oversikt.getTimer() }}</td>
                </tr>-->
                {% for oversikt in oversiktListe %}
                <tr>
                    <td><a href="prosjektrapport.php?rapportType=prosjekt&prosjektId={{ oversikt.getProsjekt().getId() }}">{{ oversikt.getNavnMedInnrykk()|raw }}</a></td>
                    {% for oType in  oppgaveTyper %}
                        <td>{{ oversikt.getTimer(oType.Id) }}</td>
                    {% endfor %}
                    <td>{{ oversikt.Timer }}</td>
                </tr>
                {% endfor %}
                <tr>
                    <td id="sum-linje">Totalt:</td>
                    {% for oType in  oppgaveTyper %}
                        <td>{{ oversiktListe[0].getTotalTimer(oType.Id) }}</td>
                    {% endfor %}
                    <td>{{ oversiktListe[0].TotalTimer }}</td>
                </tr>
            </table>
            {% elseif type == "oppgave" %}
            {% elseif type == "fremdrift" %}
                <br/>
                <br/>
                <br/>
                <br/>
                {% for fase in faseliste %}

                    <h1>{{ fase.getNavn() }}</h1>
                    <table class="table table-striped">
                        <tr>
                            <th>Oppgave</th>
                            <th>Timer utført</th>
                            <th>Estimat</th>
                            <th>Gjenstående timer</th>
                            <th>Prosent</th>
                            <th>Status</th>
                        </tr>
                        {% for oppgave in oppgaveliste %}
                            {% if oppgave.getFaseId() == fase.getId() %}
                            <tr>
                                <td>{{ oppgave.getNavn() }}</td>
                                <td>{{ oppgavereg.hentAktiveTimerPrOppgaveDesimal(oppgave.getId()) }}</td>
                                <td>{{ oppgave.getTidsestimat() }}</td>
                                <td>{{ oppgave.getTidsestimat() - oppgavereg.hentAktiveTimerPrOppgaveDesimal(oppgave.getId()) }}</td>
                                <td>{{ oppgavereg.calculatePercent(oppgave.getId()) }}%</td>
                                <td>Oppgaver har ingen status</td>
                            </tr>
                            {% endif %}
                        {% endfor %}
                    </table>
                {% endfor %}
            {% endif %}
        </div>
        
    </div>
</body>
</html>
