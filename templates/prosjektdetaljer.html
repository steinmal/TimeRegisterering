<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Prosjektdetaljer</title>
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/latest/css/bootstrap.min.css">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.1.1/jquery.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
    <link rel="stylesheet" type="text/css" href="templates/footer.css" />
</head>
<body>
    <div class="container">
        {% include 'header.html' %}
        <span class="glyphicon glyphicon-arrow-left"></span><a href="prosjektadministrering.php">Prosjektoversikt</a>

    <h1>Prosjektdetaljer for prosjekt {{ prosjekt.Navn }}</h1>
        {% if brukerTilgang.isProsjektAdmin %}
        <a href="oppgavetyper.php">Endre oppgavetyper</a><br/>
        {% endif %}
        <a href="prosjektrapport.php?prosjektId={{ prosjekt.Id }}">Vis prosjektrapport</a>
        
    {% if error == "ugyldigOppgave" %}
        <div class="alert alert-danger" role="alert">
            <span class="glyphicon glyphicon-exclamation-sign" aria-hidden="true"></span>
            <span class="sr-only">Error:</span>
            Du har ikke tilgang til oppgaven
        </div>
    {% elseif error == "ugyldigProsjekt" %}
        <div class="alert alert-danger" role="alert">
            <span class="glyphicon glyphicon-exclamation-sign" aria-hidden="true"></span>
            <span class="sr-only">Error:</span>
            Du har ikke tilgang til å legge til eller redigere faser på dette prosjektet
        </div>
    {% endif %}
        
        
    <h1>Faser</h1>
    <table class="table table-striped">
        <tr>
            <th>Navn</th>
            <th>Tilstand</th>
            <th>Startdato</th>
            <th>Sluttdato</th>
            <th></th>
        </tr>
        {% for fase in faseliste %}
            <tr>
                <td>{{ fase.Navn }}</td>
                <td>{{ fase.Tilstand }}</td>
                <td>{{ fase.StartDato }}</td>
                <td>{{ fase.SluttDato }}</td>
                <td><a href="faseoppretting.php?prosjektId={{ prosjekt.Id }}&faseId={{ fase.Id }}">rediger</a></td>
            </tr>
        {% endfor %}
    </table>
    <a href="faseoppretting.php?prosjektId={{ prosjekt.Id }}">Legg til fase</a>
    
    
    {% for fase in faseliste %}
        <h1>{{ fase.Navn }}</h1>
        <table class="table table-striped">
            <tr>
                <th>Oppgave</th>
                <th>Parent</th>
                <th>Oppgavetype</th>
                <th>Periode</th>
                <th>Estimert tid</th>
                <th>Registrert tid</th>
                <th>Godkjent tid</th>
            </tr>
            {% for oppgave in oppgaveliste %}
                {% if oppgave.FaseId == fase.Id %}
                <tr>
                    {% if brukerTilgang.isTeamleder %}
                    <td><a href="oppgavedetaljer.php?oppgave={{ oppgave.Id }}">{{ oppgave.Navn }}</a></td>
                    {% else %}
                    <td>{{ oppgave.Navn }}</td>
                    {% endif %}
                    <td>{{ oppgavereg.hentOppgave(oppgave.ParentId).Navn }}</td>
                    <td>{{ oppgavereg.hentOppgaveTypeTekst(oppgave.Type) }}</td>
                    <td>{{ oppgave.Periode }}</td>
                    <td>{{ oppgave.Tidsestimat }}</td>
                    <td>{{ oppgavereg.hentAktiveTimerPrOppgave(oppgave.Id) }}</td>
                    <td>{{ oppgavereg.hentGodkjenteTimerPrOppgave(oppgave.Id) }}</td>
                </tr>
                {% endif %}
            {% endfor %}
        </table>
    {% endfor %}

    <a href="oppgaveoppretting.php?prosjektId={{ prosjekt.Id }}">Legg til ny oppgave</a>
</div>
    {% include 'footer.html' %}
</body>
</html>